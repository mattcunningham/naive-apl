b←{∆←⍺⋄a←{⍵⊂⍨~⍵∊' '}⋄b←{⍵,q←' '}⋄η←{'',a∊b¨(⍵=1⊃¨∆)/0⊃¨∆}⋄d←{o←({+/(a∊b¨0⊃¨∆)∊⍵ ""}¨a⍵)⋄((⍴η⍺)÷((⍴η 0)+(⍴η 1)))××/(1E¯10+((⍺{+/¨(⍺{(η⍺)∊⍵ ''}¨(a⍵))}⍵)÷(⍴η⍺))×o)÷(1+o)}⋄(0d⍵)(1d⍵)÷((0d⍵)+(1d⍵))}